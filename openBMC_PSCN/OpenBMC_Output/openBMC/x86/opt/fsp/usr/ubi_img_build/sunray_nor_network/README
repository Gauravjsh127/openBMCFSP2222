The image in this directory are an example for network boot. For any questions please contact Dirk Bolte (dbolte@de.ibm.com)

==============
Functionality:
==============
This sample shows a FSP retrieving its IP address and images from a SC.
The procedure is as follows:
1. The SC has a DHCP server and a TFTP server started
2. U-Boot starts sending DHCP requests
3. SC answers, giving a filename pointing to a ubootscript
4. U-Boot retrieves that script from the TFTP server 
5. U-Boot starts the script
6. The script retrieves the kernel and initrd from the same server
7. The kernel is started
8. Linux starts, ending at a prompt 

======
Setup:
======
This setup assumes that the DHCP and TFTP server are running on a sunray card. For using network boot with any other 
setup you have to adjust your TFTP server being started by (x)inetd, your DHCP server to use a similar config as 
provided with sunray_nor/nand_sample and to listen to the interface that uses the right IP addresses. 

Server:
=======
Flash sunray_nor/nand_sample on the controller you use as server. When having a prompt, specify the right IP addresses:
- ifconfig eth0 9.6.24.224 netmask 255.255.255.0 up
- ifconfig eth1 9.6.25.224 netmask 255.255.255.0 up

kill and restart xinetd (just for to be sure):
- killall xinetd
- xinetd

Copy the files needed for the client to /tftpboot. All files needed for the client are stored within sunray_nor/nand_network.
You have to copy:
- ubootscript.img
- initrd.gz
- vmlinux.bin

start the DHCP server:
- /etc/start_dhcpd

Client:
=======
Flash sunray_nor/nand_network on the controller that is running as client. That should be all.

==================
Known Bugs/issues:
==================
There are known bugs in U-Boot regarding fetching the server IP of the DHCP answer. A workaround is to hardcode this 
IP address in the U-Boot image. In this sample, the server IP address is 9.6.24.224. For changing the server IP
adjust the environment variable "serverip" in bootenv_network.txt.
I recognized on every second boot that U-Boot got problems loading ubootscript.img. A reset always fixed that.

